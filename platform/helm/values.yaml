# Default values for sygna-hub.
# This version is optimized for AWS Marketplace deployment.
# It enables Ingress for AWS ALB and assumes an IRSA-configured EKS environment.

replicaCount: 1

frontend:
  name: hub-frontend
  image:
    repository: sygna/sygna-hub-console
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 256m
      memory: 512Mi
    limits:
      cpu: 256m
      memory: 512Mi
  service:
    type: ClusterIP
    port: 80
    annotations: {}
  probes:
    enabled: true
    path: /
    initialDelaySeconds: 15
    periodSeconds: 20

  # MODIFIED FOR AWS: Ingress is enabled by default for ALB.
  ingress:
    enabled: true
    className: "alb"
    annotations:
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/target-type: ip
      alb.ingress.kubernetes.io/group.name: sygna-hub-group
      # IMPORTANT: This value MUST be provided by the user via --set during helm upgrade.
      alb.ingress.kubernetes.io/certificate-arn: ""
    hosts:
      - host: "sygna.yourcompany.com" # IMPORTANT: This value MUST be provided by the user via --set.
        paths:
          - path: /v1
            pathType: Prefix
            backend:
              service:
                # This service name is templated in the helm chart.
                # Example for release "sygna-prod": sygna-prod-sygna-hub-helm-hub-backend
                name: sygna-hub-sygna-hub-helm-hub-backend
                port:
                  number: 8080
          - path: /
            pathType: Prefix
            backend:
              service:
                # Example for release "sygna-prod": sygna-prod-sygna-hub-helm-hub-frontend
                name: sygna-hub-sygna-hub-helm-hub-frontend
                port:
                  number: 80
  
  # IMPORTANT: This value MUST be provided by the user via --set.
  env:
    BACKEND_API_URL: ""

backend:
  name: hub-backend
  image:
    repository: sygna/sygna-hub
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: 256m
      memory: 512Mi
    limits:
      cpu: 256m
      memory: 512Mi
  service:
    type: ClusterIP
    port: 8080
    annotations: {}

  probes:
    enabled: true
    path: /v1/vasp-server-status
    initialDelaySeconds: 30
    periodSeconds: 20
  
  # MODIFIED FOR AWS: Log persistence to PVC is disabled in favor of stdout logging (e.g., CloudWatch).
  persistence:
    logs:
      enabled: false
      storageClassName: ""
      size: 1Gi

  config:
    source: configmap
    configmap:
      name: "sygna-hub-backend-config"
    # This section defines all possible environment variables that can be sourced
    # from Parameter Store or a Kubernetes Secret if needed. They are empty by default.
    environment:
      kubernetesSecretName: "sygna-hub-backend-env-secret"
      parameterStoreBasePath: "/sygna/test"
      parameters:
        DB_HOST: ""
        DB_NAME: "db"
        DB_PASSWORD: ""
        DB_PORT: "5432"
        DB_USER: ""
        DB_DRIVER: "postgres"
        ADMIN_ACCOUNT: ""
        ADMIN_PASSWORD: ""
        ALLOW_ORIGINS: "[]"
        PORT: "80"
        TRISA_SERVER_URL: "http://trisa.platform.local"
        CALLBACK_HOST: ""
        COOKIE_DOMAIN: ""
        ACCESS_TOKEN_EXPIRES_IN_SECONDS: "14400"
        DATA_ENCRYPTION_KEY: ""
        JWT_SECRET: ""
        LICENSE_KEY: ""
        VASP_CODE: ""
        EMAIL_HOST: ""
        EMAIL_ACCOUNT: ""
        EMAIL_PASSWORD: ""
        EMAIL_DISPLAY_NAME: ""
        EMAIL_SUBJECT_PREFIX: ""
        EMAIL_TLS_SUPPORT: "FALSE"
        EMAIL_FROM_EMAIL: ""

# MODIFIED FOR AWS: Service Account is created by default to support IRSA.
serviceAccount:
  create: true
  name: ""
  annotations:
    # IMPORTANT: This value MUST be provided by the user via --set to enable IRSA.
    eks.amazonaws.com/role-arn: ""